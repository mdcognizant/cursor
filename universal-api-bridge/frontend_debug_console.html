<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NewsHub Debug Console</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #00ff00;
            margin: 0;
            padding: 20px;
            font-size: 14px;
        }
        
        .header {
            background: #2a2a2a;
            padding: 15px;
            margin: -20px -20px 20px -20px;
            border-bottom: 2px solid #00ff00;
        }
        
        .title {
            color: #00ff00;
            font-size: 18px;
            font-weight: bold;
            margin: 0;
        }
        
        .status {
            margin-top: 5px;
            font-size: 12px;
            color: #888;
        }
        
        .test-section {
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .test-title {
            color: #00ffff;
            font-size: 16px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .test-result {
            margin: 10px 0;
            padding: 8px;
            border-radius: 3px;
        }
        
        .success {
            background: #1a4a1a;
            border-left: 4px solid #00ff00;
            color: #00ff00;
        }
        
        .error {
            background: #4a1a1a;
            border-left: 4px solid #ff0000;
            color: #ff6666;
        }
        
        .warning {
            background: #4a4a1a;
            border-left: 4px solid #ffaa00;
            color: #ffaa00;
        }
        
        .info {
            background: #1a1a4a;
            border-left: 4px solid #0088ff;
            color: #66aaff;
        }
        
        .btn {
            background: #333;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 3px;
            margin: 5px;
            font-family: inherit;
        }
        
        .btn:hover {
            background: #00ff00;
            color: #000;
        }
        
        .log-output {
            background: #0a0a0a;
            border: 1px solid #333;
            height: 300px;
            overflow-y: auto;
            padding: 10px;
            margin-top: 10px;
            font-size: 12px;
            white-space: pre-wrap;
        }
        
        .metric {
            display: inline-block;
            background: #333;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 3px;
            border-left: 3px solid #00ff00;
        }
        
        .metric-value {
            color: #00ffff;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="title">üîß NewsHub API Debug Console</h1>
        <div class="status" id="status">Initializing debug tools...</div>
    </div>

    <div class="test-section">
        <div class="test-title">üì° API Connectivity Tests</div>
        <button class="btn" onclick="testNewsDataAPI()">Test NewsData.io</button>
        <button class="btn" onclick="testCurrentsAPI()">Test Currents API</button>
        <button class="btn" onclick="testBothAPIs()">Test Both APIs</button>
        <button class="btn" onclick="clearLogs()">Clear Logs</button>
        <div id="apiResults"></div>
    </div>

    <div class="test-section">
        <div class="test-title">üìä Real-Time Metrics</div>
        <div id="metrics">
            <div class="metric">API Calls: <span class="metric-value" id="apiCalls">0</span></div>
            <div class="metric">Success Rate: <span class="metric-value" id="successRate">0%</span></div>
            <div class="metric">Avg Response: <span class="metric-value" id="avgResponse">0ms</span></div>
            <div class="metric">Last Error: <span class="metric-value" id="lastError">None</span></div>
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">üìù Debug Log</div>
        <div class="log-output" id="debugLog"></div>
    </div>

    <script>
        // Debug console state
        const debugState = {
            apiCalls: 0,
            successfulCalls: 0,
            responseTimes: [],
            lastError: 'None',
            logs: []
        };

        // API Configuration
        const APIs = {
            newsdata: {
                endpoint: 'https://newsdata.io/api/1/latest',
                key: 'pub_05c05ef3d5044b3fa7a3ab3b04d479e4',
                name: 'NewsData.io'
            },
            currents: {
                endpoint: 'https://api.currentsapi.services/v1/latest-news',
                key: 'zWhKbzWClaobXOpN0VDGF62kNkBh6Kbgdx-ki2AUIEoAGnah',
                name: 'Currents API'
            }
        };

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            debugState.logs.push(logEntry);
            
            const logOutput = document.getElementById('debugLog');
            logOutput.textContent += logEntry;
            logOutput.scrollTop = logOutput.scrollHeight;
            
            console.log(`[DEBUG] ${message}`);
        }

        function updateResults(containerId, message, type) {
            const container = document.getElementById(containerId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function updateMetrics() {
            document.getElementById('apiCalls').textContent = debugState.apiCalls;
            document.getElementById('successRate').textContent = 
                debugState.apiCalls > 0 ? 
                Math.round((debugState.successfulCalls / debugState.apiCalls) * 100) + '%' : '0%';
            document.getElementById('avgResponse').textContent = 
                debugState.responseTimes.length > 0 ? 
                Math.round(debugState.responseTimes.reduce((a, b) => a + b, 0) / debugState.responseTimes.length) + 'ms' : '0ms';
            document.getElementById('lastError').textContent = debugState.lastError;
        }

        async function testAPI(apiKey, config) {
            debugState.apiCalls++;
            log(`üîÑ Testing ${config.name}...`);
            
            const startTime = Date.now();
            
            try {
                const url = apiKey === 'newsdata' ? 
                    `${config.endpoint}?apikey=${config.key}&language=en&size=3` :
                    `${config.endpoint}?apiKey=${config.key}&language=en&limit=3`;
                
                log(`üìû URL: ${url.replace(config.key, 'API_KEY_HIDDEN')}`);
                
                const response = await fetch(url);
                const responseTime = Date.now() - startTime;
                debugState.responseTimes.push(responseTime);
                
                log(`‚è±Ô∏è Response time: ${responseTime}ms`);
                log(`üìä Status: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    const articleCount = apiKey === 'newsdata' ? 
                        (data.results ? data.results.length : 0) :
                        (data.news ? data.news.length : 0);
                    
                    debugState.successfulCalls++;
                    log(`‚úÖ ${config.name} SUCCESS: ${articleCount} articles`);
                    updateResults('apiResults', `‚úÖ ${config.name}: ${articleCount} articles (${responseTime}ms)`, 'success');
                } else {
                    const errorText = await response.text();
                    debugState.lastError = `${config.name}: ${response.status}`;
                    log(`‚ùå ${config.name} ERROR: ${response.status} - ${errorText}`);
                    updateResults('apiResults', `‚ùå ${config.name}: HTTP ${response.status}`, 'error');
                }
                
            } catch (error) {
                debugState.lastError = `${config.name}: ${error.message}`;
                
                if (error.message.includes('SSL') || error.message.includes('certificate')) {
                    log(`üîí ${config.name} SSL ERROR: ${error.message}`);
                    updateResults('apiResults', `üîí ${config.name}: SSL Certificate Issue (Known Problem)`, 'warning');
                } else {
                    log(`‚ùå ${config.name} NETWORK ERROR: ${error.message}`);
                    updateResults('apiResults', `‚ùå ${config.name}: ${error.message}`, 'error');
                }
            }
            
            updateMetrics();
        }

        async function testNewsDataAPI() {
            document.getElementById('apiResults').innerHTML = '';
            await testAPI('newsdata', APIs.newsdata);
        }

        async function testCurrentsAPI() {
            document.getElementById('apiResults').innerHTML = '';
            await testAPI('currents', APIs.currents);
        }

        async function testBothAPIs() {
            document.getElementById('apiResults').innerHTML = '';
            log('üöÄ Testing both APIs in parallel...');
            
            await Promise.allSettled([
                testAPI('newsdata', APIs.newsdata),
                testAPI('currents', APIs.currents)
            ]);
            
            log('‚úÖ Parallel API test completed');
        }

        function clearLogs() {
            document.getElementById('debugLog').textContent = '';
            document.getElementById('apiResults').innerHTML = '';
            debugState.logs = [];
            log('üßπ Debug console cleared');
        }

        // Auto-test on load
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('status').textContent = 'Debug console ready - Click buttons to test APIs';
            log('üîß NewsHub Debug Console initialized');
            log('üí° Use the buttons above to test API connectivity');
            log('üìä Metrics will update in real-time as you run tests');
            
            // Auto-run initial test
            setTimeout(() => {
                log('üöÄ Running initial connectivity test...');
                testBothAPIs();
            }, 1000);
        });

        // Update status every 5 seconds
        setInterval(() => {
            const now = new Date().toLocaleTimeString();
            document.getElementById('status').textContent = `Last updated: ${now} | Total API calls: ${debugState.apiCalls}`;
        }, 5000);
    </script>
</body>
</html> 